{"ast":null,"code":"import _toConsumableArray from \"C:/Users/PC/Desktop/zidonghua/project/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"chat-window flex flex-col h-screen bg-gradient-to-b from-blue-50 to-blue-100\"\n};\nvar _hoisted_2 = {\n  \"class\": \"flex-grow overflow-y-auto p-4\"\n};\nvar _hoisted_3 = {\n  key: 0,\n  \"class\": \"text-xs text-gray-400 text-center mb-2\"\n};\nvar _hoisted_4 = {\n  key: 0,\n  \"class\": \"w-10 h-10 rounded-full mr-2 flex-shrink-0 shadow-md overflow-hidden\"\n};\nvar _hoisted_5 = [\"innerHTML\"];\nvar _hoisted_6 = {\n  key: 1,\n  \"class\": \"w-10 h-10 rounded-full bg-gray-200 ml-2 flex-shrink-0 shadow-md overflow-hidden\"\n};\nvar _hoisted_7 = {\n  \"class\": \"bg-white p-4 shadow-md\"\n};\nvar _hoisted_8 = {\n  \"class\": \"max-w-3xl mx-auto flex items-center\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[6] || (_cache[6] = _createElementVNode(\"header\", {\n    \"class\": \"bg-white p-4 flex items-center shadow-md\"\n  }, [_createElementVNode(\"h1\", {\n    \"class\": \"text-xl font-semibold text-center text-blue-600 flex-grow\"\n  }, \"ÂøÖË¶Å-ËÆ∏ÊÑøÁÆ°ÂÆ∂ ü•£Libra\")], -1 /* HOISTED */)), _createElementVNode(\"main\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.messages, function (message, index) {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      \"class\": \"mb-4 animate-fade-in\"\n    }, [$options.showTimestamp(index) ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, _toDisplayString($options.formatTimestamp(message.timestamp)), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", {\n      \"class\": _normalizeClass(['flex', message.type === 'user' ? 'justify-end' : 'justify-start'])\n    }, [message.type !== 'user' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, _toConsumableArray(_cache[3] || (_cache[3] = [_createElementVNode(\"img\", {\n      src: \"/xuyuan.jpg\",\n      alt: \"AI\",\n      \"class\": \"w-full h-full object-cover\"\n    }, null, -1 /* HOISTED */)])))) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", {\n      \"class\": _normalizeClass(['max-w-3/4 p-3 rounded-lg shadow-lg', message.type === 'user' ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white' : 'bg-white text-gray-800'])\n    }, [_createElementVNode(\"div\", {\n      innerHTML: $options.formatMessage(message.content),\n      \"class\": \"break-words\"\n    }, null, 8 /* PROPS */, _hoisted_5)], 2 /* CLASS */), message.type === 'user' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, _toConsumableArray(_cache[4] || (_cache[4] = [_createElementVNode(\"img\", {\n      src: \"/user-avatar.png\",\n      alt: \"User\",\n      \"class\": \"w-full h-full object-cover\"\n    }, null, -1 /* HOISTED */)])))) : _createCommentVNode(\"v-if\", true)], 2 /* CLASS */)]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"footer\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $data.userInput = $event;\n    }),\n    type: \"text\",\n    placeholder: \"ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÊ∂àÊÅØ...\",\n    \"class\": \"flex-grow p-3 border rounded-l-full focus:outline-none focus:ring-2 focus:ring-blue-300 transition-all duration-300\",\n    onKeyup: _cache[1] || (_cache[1] = _withKeys(function () {\n      return $options.sendMessage && $options.sendMessage.apply($options, arguments);\n    }, [\"enter\"]))\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $data.userInput]]), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = function () {\n      return $options.sendMessage && $options.sendMessage.apply($options, arguments);\n    }),\n    \"class\": \"bg-blue-500 text-white p-3 rounded-r-full hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300 transition-all duration-300\"\n  }, _cache[5] || (_cache[5] = [_createElementVNode(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"class\": \"h-6 w-6\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    stroke: \"currentColor\"\n  }, [_createElementVNode(\"path\", {\n    \"stroke-linecap\": \"round\",\n    \"stroke-linejoin\": \"round\",\n    \"stroke-width\": \"2\",\n    d: \"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\"\n  })], -1 /* HOISTED */)]))])])]);\n}","map":{"version":3,"names":["key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_Fragment","_renderList","$data","messages","message","index","$options","showTimestamp","_hoisted_3","_toDisplayString","formatTimestamp","timestamp","_createCommentVNode","_normalizeClass","type","_hoisted_4","_toConsumableArray","_cache","src","alt","innerHTML","formatMessage","content","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","$event","userInput","placeholder","onKeyup","_withKeys","sendMessage","apply","arguments","onClick","xmlns","fill","viewBox","stroke","d"],"sources":["C:\\Users\\PC\\Desktop\\zidonghua\\project\\frontend\\src\\components\\ChatWindow.vue"],"sourcesContent":["<template>\r\n  <div class=\"chat-window flex flex-col h-screen bg-gradient-to-b from-blue-50 to-blue-100\">\r\n    <header class=\"bg-white p-4 flex items-center shadow-md\">\r\n      <h1 class=\"text-xl font-semibold text-center text-blue-600 flex-grow\">ÂøÖË¶Å-ËÆ∏ÊÑøÁÆ°ÂÆ∂ ü•£Libra</h1>\r\n    </header>\r\n\r\n    <main class=\"flex-grow overflow-y-auto p-4\">\r\n      <div v-for=\"(message, index) in messages\" :key=\"index\" class=\"mb-4 animate-fade-in\">\r\n        <div v-if=\"showTimestamp(index)\" class=\"text-xs text-gray-400 text-center mb-2\">\r\n          {{ formatTimestamp(message.timestamp) }}\r\n        </div>\r\n        <div :class=\"['flex', message.type === 'user' ? 'justify-end' : 'justify-start']\">\r\n          <div v-if=\"message.type !== 'user'\" class=\"w-10 h-10 rounded-full mr-2 flex-shrink-0 shadow-md overflow-hidden\">\r\n            <img src=\"/xuyuan.jpg\" alt=\"AI\" class=\"w-full h-full object-cover\">\r\n          </div>\r\n          <div :class=\"['max-w-3/4 p-3 rounded-lg shadow-lg', \r\n            message.type === 'user' ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white' : 'bg-white text-gray-800']\">\r\n            <div v-html=\"formatMessage(message.content)\" class=\"break-words\"></div>\r\n          </div>\r\n          <div v-if=\"message.type === 'user'\" class=\"w-10 h-10 rounded-full bg-gray-200 ml-2 flex-shrink-0 shadow-md overflow-hidden\">\r\n            <img src=\"/user-avatar.png\" alt=\"User\" class=\"w-full h-full object-cover\">\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </main>\r\n\r\n    <footer class=\"bg-white p-4 shadow-md\">\r\n      <div class=\"max-w-3xl mx-auto flex items-center\">\r\n        <input\r\n          v-model=\"userInput\"\r\n          type=\"text\"\r\n          placeholder=\"ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÊ∂àÊÅØ...\"\r\n          class=\"flex-grow p-3 border rounded-l-full focus:outline-none focus:ring-2 focus:ring-blue-300 transition-all duration-300\"\r\n          @keyup.enter=\"sendMessage\"\r\n        />\r\n        <button\r\n          @click=\"sendMessage\"\r\n          class=\"bg-blue-500 text-white p-3 rounded-r-full hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300 transition-all duration-300\"\r\n        >\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\r\n          </svg>\r\n        </button>\r\n      </div>\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  name: 'ChatWindow',\r\n  data() {\r\n    return {\r\n      messages: [],\r\n      userInput: '',\r\n      isAiThinking: false\r\n    }\r\n  },\r\n  methods: {\r\n    async sendMessage() {\r\n      if (this.userInput.trim() === '' || this.isAiThinking) return\r\n\r\n      const timestamp = new Date()\r\n      this.messages.push({ type: 'user', content: this.userInput, timestamp })\r\n      this.isAiThinking = true\r\n      const userInput = this.userInput\r\n      this.userInput = ''\r\n\r\n      try {\r\n        const response = await axios.post('http://10.6.16.151:5000/chat', { \r\n          message: userInput,\r\n          user_id: 'default_user'  // Ê∑ªÂä†Áî®Êà∑ID\r\n        })\r\n        this.messages.push({ type: 'ai', content: response.data.reply, timestamp: new Date() })\r\n      } catch (error) {\r\n        console.error('Error:', error)\r\n        this.messages.push({ type: 'error', content: 'Êä±Ê≠â,Âá∫Áé∞‰∫Ü‰∏Ä‰∏™ÈîôËØØ„ÄÇ', timestamp: new Date() })\r\n      } finally {\r\n        this.isAiThinking = false\r\n      }\r\n    },\r\n    goBack() {\r\n      // ÂÆûÁé∞ËøîÂõûÈÄªËæë\r\n    },\r\n    showTimestamp(index) {\r\n      if (index === 0) return true\r\n      const prevMessage = this.messages[index - 1]\r\n      const currentMessage = this.messages[index]\r\n      return new Date(currentMessage.timestamp) - new Date(prevMessage.timestamp) > 300000 // 5ÂàÜÈíü\r\n    },\r\n    formatTimestamp(timestamp) {\r\n      const date = new Date(timestamp)\r\n      return `${date.getMonth() + 1}Êúà${date.getDate()}Êó• ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`\r\n    },\r\n    formatMessage(content) {\r\n      return content.replace(/\\n/g, '<br>')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.chat-window {\r\n  width: 750px;\r\n  height: 1334px;\r\n  margin: 0 auto;\r\n  font-family: 'Arial', sans-serif;\r\n}\r\n\r\n.animate-fade-in {\r\n  animation: fadeIn 0.5s ease-out;\r\n}\r\n\r\n@keyframes fadeIn {\r\n  from { opacity: 0; transform: translateY(10px); }\r\n  to { opacity: 1; transform: translateY(0); }\r\n}\r\n\r\n/* Ê∑ªÂä†ÂìçÂ∫îÂºèËÆæËÆ° */\r\n@media (max-width: 768px) {\r\n  .chat-window {\r\n    width: 100%;\r\n    height: 100vh;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";;;EACO,SAAM;AAA8E;;EAKjF,SAAM;AAA+B;;EAN/CA,GAAA;EAQyC,SAAM;;;EAR/CA,GAAA;EAY8C,SAAM;;iBAZpD;;EAAAA,GAAA;EAmB8C,SAAM;;;EAOxC,SAAM;AAAwB;;EAC/B,SAAM;AAAqC;;uBA1BpDC,mBAAA,CA4CM,OA5CNC,UA4CM,G,0BA3CJC,mBAAA,CAES;IAFD,SAAM;EAA0C,IACtDA,mBAAA,CAA0F;IAAtF,SAAM;EAA2D,GAAC,iBAAe,E,sBAGvFA,mBAAA,CAkBO,QAlBPC,UAkBO,I,kBAjBLH,mBAAA,CAgBMI,SAAA,QAvBZC,WAAA,CAOsCC,KAAA,CAAAC,QAAQ,EAP9C,UAOmBC,OAAO,EAAEC,KAAK;yBAA3BT,mBAAA,CAgBM;MAhBqCD,GAAG,EAAEU,KAAK;MAAE,SAAM;QAChDC,QAAA,CAAAC,aAAa,CAACF,KAAK,K,cAA9BT,mBAAA,CAEM,OAFNY,UAEM,EAAAC,gBAAA,CADDH,QAAA,CAAAI,eAAe,CAACN,OAAO,CAACO,SAAS,qBAT9CC,mBAAA,gBAWQd,mBAAA,CAWM;MAXA,SAXde,eAAA,UAW8BT,OAAO,CAACU,IAAI;QACrBV,OAAO,CAACU,IAAI,e,cAAvBlB,mBAAA,CAEM,OAFNmB,UAEM,EAAAC,kBAAA,CAAAC,MAAA,QAAAA,MAAA,OADJnB,mBAAA,CAAmE;MAA9DoB,GAAG,EAAC,aAAa;MAACC,GAAG,EAAC,IAAI;MAAC,SAAM;sCAblDP,mBAAA,gBAeUd,mBAAA,CAGM;MAHA,SAfhBe,eAAA,wCAe4ET,OAAO,CAACU,IAAI;QAE5EhB,mBAAA,CAAuE;MAAlEsB,SAAuC,EAA/Bd,QAAA,CAAAe,aAAa,CAACjB,OAAO,CAACkB,OAAO;MAAG,SAAM;4BAjB/DC,UAAA,E,kBAmBqBnB,OAAO,CAACU,IAAI,e,cAAvBlB,mBAAA,CAEM,OAFN4B,UAEM,EAAAR,kBAAA,CAAAC,MAAA,QAAAA,MAAA,OADJnB,mBAAA,CAA0E;MAArEoB,GAAG,EAAC,kBAAkB;MAACC,GAAG,EAAC,MAAM;MAAC,SAAM;sCApBzDP,mBAAA,e;oCA0BId,mBAAA,CAkBS,UAlBT2B,UAkBS,GAjBP3B,mBAAA,CAgBM,OAhBN4B,UAgBM,G,gBAfJ5B,mBAAA,CAME;IAlCV,uBAAAmB,MAAA,QAAAA,MAAA,gBAAAU,MAAA;MAAA,OA6BmBzB,KAAA,CAAA0B,SAAS,GAAAD,MAAA;IAAA;IAClBb,IAAI,EAAC,MAAM;IACXe,WAAW,EAAC,YAAY;IACxB,SAAM,qHAAqH;IAC1HC,OAAK,EAAAb,MAAA,QAAAA,MAAA,MAjChBc,SAAA;MAAA,OAiCwBzB,QAAA,CAAA0B,WAAA,IAAA1B,QAAA,CAAA0B,WAAA,CAAAC,KAAA,CAAA3B,QAAA,EAAA4B,SAAA,CAAW;IAAA;iEAJhBhC,KAAA,CAAA0B,SAAS,E,GAMpB9B,mBAAA,CAOS;IANNqC,OAAK,EAAAlB,MAAA,QAAAA,MAAA;MAAA,OAAEX,QAAA,CAAA0B,WAAA,IAAA1B,QAAA,CAAA0B,WAAA,CAAAC,KAAA,CAAA3B,QAAA,EAAA4B,SAAA,CAAW;IAAA;IACnB,SAAM;gCAENpC,mBAAA,CAEM;IAFDsC,KAAK,EAAC,4BAA4B;IAAC,SAAM,SAAS;IAACC,IAAI,EAAC,MAAM;IAACC,OAAO,EAAC,WAAW;IAACC,MAAM,EAAC;MAC7FzC,mBAAA,CAA6G;IAAvG,gBAAc,EAAC,OAAO;IAAC,iBAAe,EAAC,OAAO;IAAC,cAAY,EAAC,GAAG;IAAC0C,CAAC,EAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}